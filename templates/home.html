{% extends "base.html" %}
{% load static %}

{% block title %}Home{% endblock %}

{% block content %}
<div class="container mx-auto p-4 space-y-8"> <!-- Added space-y-8 for gap between containers -->
    <div id="welcomeContainer" class="flex items-center mb-4">
        <h1 id="welcomeText" class="text-3xl font-bold mb-2">Welcome Back!</h1>
        <h2 id="dateTime" class="text-sm font-semibold ml-4 sliding-animation" style="opacity: 0.7;"></h2>
    </div>
    <div class="flex flex-wrap gap-4 mt-4 mb-3">
        <div class="bg-gray-800 p-6 rounded-lg shadow-lg revenue-box">
            <p class="text-2xl xl font-bold text-blue-400">₹{{ today_revenue }}</p>
            <h2 class="text-sm font-semibold text-white">Today's Revenue</h2>
        </div>
        <div class="bg-gray-800 p-6 rounded-lg shadow-lg revenue-box">
            <p class="text-2xl xl font-bold text-blue-400">{{ today_orders_count }}</p>
            <h2 class="text-sm font-semibold text-white">Today's Orders</h2>
        </div>
    </div>
    <div class="mt-10" style="width: 650px;">
        <div class="bg-gray-800 p-4 rounded-lg shadow-lg">
            <h2 class="text-xl font-bold mb-4">Today's Orders</h2>
            <div class="bg-gray-800 p-2" style="max-height: 400px; overflow-y: auto; scrollbar-width: none; -ms-overflow-style: none;"> <!-- Added max-height and overflow-y -->
                <style>
                    .bg-gray-800::-webkit-scrollbar {
                        display: none; /* Hide scrollbar for WebKit browsers */
                    }
                </style>
                <div class="flex flex-col gap-2">
                    {% for order in today_orders %}
                    <div class="p-2 rounded-lg shadow-md flex justify-between {% if order.status == 'deleted' %}bg-red-700{% else %}bg-gray-700{% endif %}" style="width: 600px;">
                        <p class="mb-1 text-sm"><strong>Order ID:</strong> {{ order.order_id }}</p>
                        <div class="flex flex-col items-end">
                            <p class="mb-1 text-sm text-white px-2 py-1 rounded-md"><strong>Total:</strong> ₹{{ order.grand_total }}</p> <!-- Added capsule around amount -->
                            <p class="mb-1 text-sm"><strong></strong> {{ order.time }}</p> <!-- Added time of order -->
                        </div>
                    </div>
                    {% empty %}
                    <div class="text-center">
                        <p class="text-white">No orders found for today.</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
@keyframes slide {
    0% { transform: translateX(-30%); opacity: 0; }
    100% { transform: translateX(0); opacity: 1; }
}

.sliding-animation {
    display: inline-block;
    animation: slide 3s ease-in-out;
}

.revenue-box {
    width: 200px; /* Fixed width */
    height: 120px; /* Fixed height */
    padding: 1.5rem; /* Increased padding */
    border-radius: 0.5rem; /* Add border radius */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Add shadow */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const dateTime = document.getElementById('dateTime');

    function triggerAnimation(element) {
        element.classList.remove('sliding-animation');
        void element.offsetWidth; // Trigger reflow
        element.classList.add('sliding-animation');
    }

    function updateDateTime() {
        const now = new Date();
        const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit' };
        dateTime.textContent = now.toLocaleDateString('en-US', options);
    }

    triggerAnimation(dateTime);
    setInterval(() => {
        triggerAnimation(dateTime);
    }, 300000); // 300000ms = 5 minutes

    updateDateTime();
    setInterval(updateDateTime, 1000); // Update the date and time every second
});
</script>
{% endblock %}
